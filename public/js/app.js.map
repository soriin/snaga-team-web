{"version":3,"sources":["app/modules/core/core.module.js","app/modules/events/events.module.js","app/modules/layout/layout.module.js","app/modules/profile/profile.module.js","app/app.module.js","app/app.routes.js","app/modules/core/components/inputBox.ctrl.js","app/modules/core/components/inputBox.directive.js","app/modules/core/constants.service.js","app/modules/core/dataAccess/eventAccess.factory.js","app/modules/core/dataAccess/userAccess.factory.js","app/modules/core/httprequestintercept.factory.js","app/modules/core/interpolate.filter.js","app/modules/core/login.ctrl.js","app/modules/core/version.service.js","app/modules/events/events.list.ctrl.js","app/modules/events/events.new.ctrl.js","app/modules/layout/app.ctrl.js","app/modules/layout/appVersion.directive.js","app/modules/profile/admin.ctrl.js","app/modules/profile/adminSwitch.directive.js","app/modules/profile/profile.ctrl.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"e:\\Code\\snaga-team\\web\\public\\js\\app.js","sourcesContent":["$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    var app = angular.module('app.core', ['ngSanitize', 'ngResource', 'ui.router', 'ngCookies', 'ng-polymer-elements']);\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    var app = angular.module('app.events', ['app.core']);\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    var app = angular.module('app.layout', ['app.core']);\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    var app = angular.module('app.profile', ['app.core']);\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    var app = angular.module('app', ['app.core', 'app.events', 'app.layout', 'app.profile']);\n    app.constant('VERSION', '0.1.0');\n    app.config(['$resourceProvider', function($resourceProvider) {\n      $resourceProvider.defaults.stripTrailingSlashes = false;\n    }]);\n    app.config([\"$httpProvider\", function($httpProvider) {\n      $httpProvider.interceptors.push('authHttpRequestInterceptor');\n    }]);\n    app.run(function($rootScope) {\n      $rootScope.$on('$stateChangeStart', function(e, to) {\n        console.log(\"routing to:\");\n        console.log(to);\n      });\n    });\n    app.run(function($rootScope) {\n      $rootScope.$on('$stateChangeSuccess', function(e, to) {\n        console.log(\"routed to:\");\n        console.log(to);\n      });\n    });\n    app.run(function($rootScope) {\n      $rootScope.$on('$stateChangeError', function(e, toState, toParams, fromState, fromParams, error) {\n        console.log(\"error routing to:\");\n        console.log(toState);\n        console.log(error);\n      });\n    });\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module('app').config(['$stateProvider', '$locationProvider', '$urlRouterProvider', function appConfig($stateProvider, $locationProvider, $urlRouterProvider) {\n      $locationProvider.hashPrefix('!');\n      $urlRouterProvider.otherwise(\"/events\");\n      var getProfileRes = ['UserAccess', '$stateParams', '$q', 'currentUser', getProfileData];\n      var getCurrentUserRes = ['UserAccess', '$window', '$rootScope', '$q', '$state', fetchCurrentUser];\n      $stateProvider.state('wrapper', {templateUrl: \"partials/layout/default.layout.html\"}).state('login', {\n        url: \"/login\",\n        views: {\"mainView\": {\n            templateUrl: \"partials/core/login.html\",\n            controller: 'LoginCtrl as login'\n          }}\n      }).state('events', {\n        parent: 'wrapper',\n        url: \"/events\",\n        views: {\"mainView\": {\n            templateUrl: \"partials/events/events.list.html\",\n            controller: 'EventsListCtrl as events'\n          }}\n      }).state('events.new', {\n        parent: 'wrapper',\n        url: \"/events/new\",\n        views: {\"mainView\": {\n            templateUrl: \"partials/events/events.new.html\",\n            controller: 'EventsNewCtrl as event'\n          }}\n      }).state('profile', {\n        parent: 'wrapper',\n        url: \"/profile\",\n        views: {\"mainView\": {\n            templateUrl: \"partials/profile/profile.html\",\n            controller: 'ProfileCtrl as profile'\n          }},\n        resolve: {\n          currentUser: getCurrentUserRes,\n          profileData: getProfileRes\n        }\n      }).state('profile-other', {\n        url: \"/profile/:userId\",\n        views: {\"mainView\": {\n            templateUrl: \"partials/profile/profile.html\",\n            controller: 'ProfileCtrl as profile'\n          }},\n        resolve: {\n          currentUser: getCurrentUserRes,\n          profileData: getProfileRes\n        }\n      });\n      function fetchCurrentUser(UserAccess, $window, $rootScope, $q, $state) {\n        console.log(\"entering fetchCurrentUser\");\n        if (!!$rootScope.currentUser) {\n          return $rootScope.currentUser;\n        }\n        var defer = $q.defer();\n        if (!!$window.gapi.auth2 && $window.gapi.auth2.getAuthInstance().isSignedIn.get() == true) {\n          console.log(\"fetching current user\");\n          UserAccess.createUser().then(function(data) {\n            if (!!data) {\n              console.log(\"setting current user\");\n              $rootScope.currentUser = data;\n              $rootScope.isLoggedIn = true;\n              defer.resolve(data);\n            } else {\n              console.error(\"error fetching current user\");\n              defer.reject();\n              $state.go(\"events\");\n            }\n          });\n        } else {\n          defer.reject();\n          $state.go(\"login\");\n        }\n        return defer.promise;\n        console.log(\"not fetching current user\");\n      }\n      function getProfileData(UserAccess, $stateParams, $q, currentUser) {\n        if ($stateParams.userId === undefined) {\n          console.log(\"getProfileData returning current user\");\n          return currentUser;\n        }\n        console.log(\"getProfileData fetching userId \" + $stateParams.userId);\n        return UserAccess.getUser($stateParams.userId);\n      }\n      return $locationProvider.html5Mode(false);\n    }]);\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module('app.core').controller('InputBoxController', ['$scope', '$rootScope', InputBoxCtrl]);\n    function InputBoxCtrl($scope, $rootScope) {}\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module('app.core').directive('snagaInputBox', inputBox);\n    function inputBox() {\n      return {\n        restrict: 'E',\n        templateUrl: 'partials/core/components/input_box.html',\n        controller: 'InputBoxController as ib',\n        bindToController: true,\n        scope: {\n          label: '@',\n          model: '='\n        }\n      };\n    }\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module(\"app.core\").service(\"constants\", [\"$location\", constants]);\n    function constants($location) {}\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module('app.core').factory('EventAccess', ['$http', EventAccess]);\n    function EventAccess($http, logger) {\n      var svc = {\n        createEvent: createEvent,\n        updateEvent: updateEvent,\n        getEvents: getEvents\n      };\n      return svc;\n      function getEvents() {\n        return sendReq({\n          method: \"GET\",\n          url: \"/api/events/\"\n        });\n      }\n      function createEvent(body) {\n        return sendReq({\n          method: \"POST\",\n          url: \"/api/events/\",\n          data: body\n        });\n      }\n      function updateEvent(id, body) {\n        return sendReq({\n          method: \"PUT\",\n          url: \"/api/events/\" + id,\n          data: body\n        });\n      }\n      function sendReq(req) {\n        return $http(req).then(onSuccess, onError);\n      }\n      function onSuccess(response) {\n        return response.data;\n      }\n      function onError(error) {\n        console.log(error);\n      }\n    }\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module('app.core').factory('UserAccess', ['$http', UserAccess]);\n    function UserAccess($http, logger) {\n      var svc = {\n        createUser: createUser,\n        updateUser: updateUser,\n        getUser: getUser,\n        addGroup: addGroup,\n        removeGroup: removeGroup\n      };\n      return svc;\n      function createUser() {\n        return sendReq({\n          method: \"POST\",\n          url: \"/api/users/\"\n        });\n      }\n      function updateUser(id, body) {\n        return sendReq({\n          method: \"PUT\",\n          url: \"/api/users/\" + id,\n          data: body\n        });\n      }\n      function getUser(id) {\n        return sendReq({\n          method: \"GET\",\n          url: \"/api/users/\" + id\n        });\n      }\n      function addGroup(id, groupName) {\n        return sendReq({\n          method: \"PUT\",\n          url: \"/api/users/\" + id + \"/groups\",\n          data: {\n            Action: \"add\",\n            GroupName: groupName\n          }\n        });\n      }\n      function removeGroup(id, groupName) {\n        return sendReq({\n          method: \"PUT\",\n          url: \"/api/users/\" + id + \"/groups\",\n          data: {\n            Action: \"remove\",\n            GroupName: groupName\n          }\n        });\n      }\n      function sendReq(req) {\n        return $http(req).then(onSuccess, onError);\n      }\n      function onSuccess(response) {\n        return response.data;\n      }\n      function onError(error) {\n        console.log(error);\n      }\n    }\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module(\"app.core\").factory(\"authHttpRequestInterceptor\", ['$cookieStore', httpRequestIntercept]);\n    function httpRequestIntercept($cookieStore) {\n      var svc = {request: request};\n      return svc;\n      function request(config) {\n        var token = $cookieStore.get('token');\n        if (token != undefined && token.length > 0) {\n          config.headers[\"Auth-Token\"] = token;\n        }\n        return config;\n      }\n    }\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module('app.core').filter('interpolate', interpolate);\n    function interpolate($version) {\n      return function(text) {\n        return String(text).replace(/\\%VERSION\\%/mg, $version);\n      };\n    }\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module('app.core').controller('LoginCtrl', ['$window', '$location', '$state', '$cookieStore', '$rootScope', LoginCtrl]);\n    function LoginCtrl($window, $location, $state, $cookieStore, $rootScope) {\n      var loginVm = this;\n      loginVm.login = login;\n      loginVm.logout = logout;\n      loginVm.renderLogin = renderLogin;\n      loginVm.notRendered = true;\n      $rootScope.$watch('isLoggedIn', function(val) {\n        loginVm.isLoggedIn = val;\n      });\n      function renderLogin() {\n        console.log(\"rendering login button\");\n        $window.gapi.signin2.render('googleSigninBtn', {\n          'scope': 'profile',\n          'width': 100,\n          'height': 40,\n          'longtitle': false,\n          'theme': 'dark',\n          'onsuccess': login,\n          'onfailure': loginFail\n        });\n        loginVm.notRendered = false;\n      }\n      function loginFail(e) {\n        console.log(e);\n      }\n      function login(googleUser) {\n        var profile = googleUser.getBasicProfile();\n        console.log(\"Name: \" + profile.getName());\n        console.log(\"Image URL: \" + profile.getImageUrl());\n        console.log(\"Email: \" + profile.getEmail());\n        var id_token = googleUser.getAuthResponse().id_token;\n        console.log(\"ID Token: \" + id_token);\n        $cookieStore.put('token', id_token);\n        $window.gapi.auth2.getAuthInstance().then(function() {\n          $rootScope.isLoggedIn = true;\n          $rootScope.$apply();\n          $state.go(\"events\");\n        });\n      }\n      function logout() {\n        var auth2 = $window.gapi.auth2.getAuthInstance();\n        auth2.signOut().then(function() {\n          $rootScope.isLoggedIn = false;\n          $rootScope.$apply();\n          console.log('User signed out.');\n          $state.go(\"events\");\n        });\n      }\n    }\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module('app.core').factory('$version', version);\n    function version(VERSION) {\n      return VERSION;\n    }\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module('app.events').controller('EventsListCtrl', ['$state', 'EventAccess', EventsListCtrl]);\n    function EventsListCtrl($state, EventAccess) {\n      var eventsVm = this;\n      eventsVm.Create = create;\n      eventsVm.Events = [];\n      activate();\n      function activate() {\n        EventAccess.getEvents().then(refreshEvents);\n      }\n      function create() {\n        $state.go(\"events.new\");\n      }\n      function refreshEvents(data) {\n        if (Object.prototype.toString.call(data) === '[object Array]') {\n          eventsVm.Events = data;\n        }\n      }\n    }\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module('app.events').controller('EventsNewCtrl', ['$state', EventsNewCtrl]);\n    function EventsNewCtrl($state) {\n      var eventsVm = this;\n      eventsVm.Create = create;\n      function create() {\n        $state.go(\"events\");\n      }\n    }\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module('app.layout').controller('AppCtrl', ['$rootScope', AppCtrl]);\n    function AppCtrl($rootScope) {\n      var appVm = this;\n      $rootScope.isLoggedIn = false;\n    }\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module('app.layout').directive('appVersion', appVersion);\n    function appVersion() {\n      return {\n        restrict: 'E',\n        template: '<span>Snaga Team v{{ \"%VERSION%\" | interpolate  }}</span>',\n        link: link\n      };\n      function link($scope, $element, $attrs) {}\n    }\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module('app.profile').controller('AdminController', ['UserAccess', '$scope', '$rootScope', AdminCtrl]);\n    function AdminCtrl(UserAccess, $scope, $rootScope) {\n      var adminVm = this;\n      adminVm.addAdmin = addAdmin;\n      adminVm.removeAdmin = removeAdmin;\n      adminVm.currentUser = $rootScope.currentUser;\n      adminVm.profileUser = $scope.profileUser;\n      adminVm.IsAdmin = adminVm.profileUser.IsAdmin;\n      adminVm.IsNotAdmin = !adminVm.profileUser.IsAdmin;\n      function addAdmin() {\n        UserAccess.addGroup($scope.profileUser.Id, \"admin\").then(updateData);\n      }\n      function removeAdmin() {\n        UserAccess.removeGroup($scope.profileUser.Id, \"admin\").then(updateData);\n      }\n      function updateData(data) {\n        var user = data;\n        $scope.profileUser = user;\n        adminVm.IsAdmin = user.IsAdmin;\n        adminVm.IsNotAdmin = !user.IsAdmin;\n        if (user.UserId == $rootScope.currentUser.UserId) {\n          $rootScope.currentUser = user;\n        }\n      }\n    }\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module('app.profile').directive('snagaAdminSwitch', adminSwitch);\n    function adminSwitch() {\n      return {\n        restrict: 'E',\n        templateUrl: 'partials/profile/admin_switch.html',\n        controller: 'AdminController as admin',\n        scope: {profileUser: '='}\n      };\n    }\n  })();\n  return {};\n});\n\n","$traceurRuntime.ModuleStore.getAnonymousModule(function() {\n  \"use strict\";\n  (function() {\n    'use strict';\n    angular.module('app.profile').controller('ProfileCtrl', ['$window', '$state', 'UserAccess', '$rootScope', 'profileData', '$stateParams', ProfileCtrl]);\n    function ProfileCtrl($window, $state, UserAccess, $rootScope, profileData, $stateParams) {\n      var profileVm = this;\n      profileVm.update = update;\n      profileVm.user = {};\n      activate(profileData);\n      function activate(data) {\n        setProfileData(data);\n      }\n      function update() {\n        UserAccess.updateUser(profileVm.user.Id, {\n          FirstName: profileVm.user.FirstName,\n          LastName: profileVm.user.LastName,\n          DisplayName: profileVm.user.DisplayName,\n          InGameName: profileVm.user.InGameName,\n          Email: profileVm.user.Email\n        }).then(setProfileData);\n      }\n      function setProfileData(data) {\n        profileVm.user = data;\n        if ($rootScope.currentUser.UserId == data.UserId) {\n          $rootScope.currentUser = data;\n        }\n      }\n    }\n  })();\n  return {};\n});\n\n"]}